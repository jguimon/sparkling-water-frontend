<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compare Sparkling Water Prices - Cheapest Online Deals</title>
    <meta name="description" content="Find the cheapest sparkling water prices online. Compare brands like LaCroix, Liquid Death, and more.">
    <meta name="keywords" content="sparkling water prices, cheapest sparkling water, LaCroix deals, Liquid Death prices, best sparkling water deals">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://sparklingwaterdeals.com">
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        .price-container { margin-top: 20px; font-size: 18px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 10px; border-bottom: 1px solid #ddd; text-align: left; }
        th { background: #f4f4f4; cursor: pointer; }
        th:hover { background: #e8e8e8; }
        .sort-controls {
            margin: 20px 0;
            text-align: center;
        }
        .sort-controls label {
            margin-right: 20px;
            cursor: pointer;
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .loading { 
            text-align: center; 
            padding: 20px;
            font-style: italic;
            color: #666;
        }
        .error {
            color: #dc3545;
            padding: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>Best Sparkling Water Deals Online</h1>
    <h2>Compare Prices from Multiple Retailers</h2>

    <div class="sort-controls">
        <label>
            <input type="radio" name="sort" value="priceCan" checked>
            Sort by Price per Can
        </label>
        <label>
            <input type="radio" name="sort" value="priceFluidOz">
            Sort by Price per Fluid Ounce
        </label>
        <label>
            <input type="radio" name="sort" value="pricePack">
            Sort by Price per Pack
        </label>
    </div>

    <table>
        <thead>
            <tr>
                <th>Product</th>
                <th>Store</th>
                <th>Cans per Pack</th>
                <th>Price per Fluid Ounce</th>
                <th>Price per Can</th>
                <th>Price per Pack</th>
            </tr>
        </thead>
        <tbody class="price-container">
            <tr><td colspan="6" class="loading">Fetching latest prices...</td></tr>
        </tbody>
    </table>

    <script>
        async function fetchPrices() {
            const container = document.querySelector('.price-container');
            try {
                const response = await fetch('/static_products.json'); // Fetch static JSON file
                
                if (!response.ok) {
                    throw new Error('Failed to load product data');
                }
                
                const data = await response.json();

                container.innerHTML = data.map(item => `
                    <tr data-priceCan="${parseFloat(item.price_per_can)}" 
                        data-priceFluidOz="${parseFloat(item.price_per_fluid_ounce)}" 
                        data-pricePack="${parseFloat(item.price_per_pack)}">
                        <td><a href="${item.product.url}" target="_blank">${item.product.name}</a></td>
                        <td>${item.store}</td>
                        <td>${item.cans_per_pack}</td>
                        <td>$${item.price_per_fluid_ounce.toFixed(2)}</td>
                        <td>$${item.price_per_can.toFixed(2)}</td>
                        <td>$${item.price_per_pack.toFixed(2)}</td>
                    </tr>
                `).join('');

                function sortTable(sortBy) {
                    const tbody = document.querySelector(".price-container");
                    const rows = Array.from(tbody.querySelectorAll("tr"));

                    rows.sort((a, b) => {
                        const aPrice = parseFloat(a.dataset[sortBy]);
                        const bPrice = parseFloat(b.dataset[sortBy]);
                        return aPrice - bPrice;
                    });

                    tbody.innerHTML = "";
                    rows.forEach(row => tbody.appendChild(row));
                }

                document.querySelectorAll('input[name="sort"]').forEach(radio => {
                    radio.addEventListener("change", function () {
                        sortTable(this.value);
                    });
                });

                sortTable("priceCan"); // Default sort by Price per Can
            } catch (error) {
                console.error('Error:', error);
                container.innerHTML = '<tr><td colspan="6" class="error">Error loading prices. Please check again later.</td></tr>';
            }
        }

        document.addEventListener('DOMContentLoaded', fetchPrices);
    </script>
</body>
</html>
